<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Tic Tac Toe</title>
<style>
  :root{--bg:#fafafa;--card:#ffffff;--muted:#6b7280;--accent:#ef6c2f;--win:#16a34a;--lose:#ef4444}
  *{box-sizing:border-box}
  body{margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto;display:flex;min-height:100vh;align-items:center;justify-content:center;background:linear-gradient(180deg,#fff,#f3f4f6)}
  .wrap{width:min(920px,96vw);display:grid;grid-template-columns:1fr 420px;gap:24px}
  .card{background:var(--card);padding:28px;border-radius:12px;box-shadow:0 6px 24px rgba(15,23,42,.06)}
  h1{margin:0;font-size:20px}
  p.lead{color:var(--muted);margin-top:12px}

  /* Game area */
  .board{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;margin:18px 0}
  .cell{aspect-ratio:1/1;display:grid;place-items:center;font-size:48px;font-weight:800;border-radius:8px;background:#f8fafc;border:2px solid rgba(15,23,42,.04);cursor:pointer;user-select:none;transition:transform .08s ease,background .12s}
  .cell:hover{transform:translateY(-4px)}
  .cell.disabled{cursor:not-allowed;opacity:.6}

  .status{display:flex;gap:12px;align-items:center;justify-content:space-between}
  .status .turn{font-weight:700}
  .controls{display:flex;gap:8px}
  .btn{background:linear-gradient(180deg,#fff,#fff);border:1px solid rgba(0,0,0,.06);padding:8px 12px;border-radius:8px;cursor:pointer}
  .btn.primary{background:var(--accent);color:#fff;border:none}
  .toast{padding:10px;border-radius:8px;font-weight:700}
  .toast.win{background:rgba(16,185,129,.08);color:var(--win);border:1px solid rgba(16,185,129,.18)}
  .toast.draw{background:rgba(99,102,241,.06);color:#4338ca;border:1px solid rgba(99,102,241,.12)}

  /* Right column */
  .info{display:flex;flex-direction:column;gap:12px}
  .score{display:flex;gap:12px}
  .score .item{background:#fbfbff;padding:10px;border-radius:8px;min-width:96px;text-align:center}
  footer{font-size:13px;color:var(--muted);margin-top:8px}

  @media (max-width:920px){.wrap{grid-template-columns:1fr}}
</style>
</head>
<body>
<div class="wrap">
  <section class="card">
    <h1>Tic Tac Toe</h1>
    <p class="lead">Classic 2-player Tic Tac Toe. Players alternate placing X and O. The first to make 3 in a row wins. Reset anytime.</p>

    <div class="status" aria-live="polite">
      <div class="turn" id="turn">Turn: <strong id="turnPlayer">X</strong></div>
      <div class="controls">
        <button class="btn" id="btnReset">Reset</button>
        <button class="btn" id="btnUndo" title="Undo last move">Undo</button>
      </div>
    </div>

    <div class="board" id="board" aria-label="Tic Tac Toe board"></div>

    <div id="result" class="toast" style="display:none;margin-top:12px"></div>
  </section>

  <aside class="card info">
    <div>
      <h3 style="margin:0">Game Info</h3>
      <p style="margin:8px 0 0;color:var(--muted)">Local, two-player game. Click cells to play. The board checks for wins/draws after each move.</p>
    </div>

    <div class="score">
      <div class="item">X Wins<br><strong id="scoreX">0</strong></div>
      <div class="item">O Wins<br><strong id="scoreO">0</strong></div>
      <div class="item">Draws<br><strong id="scoreD">0</strong></div>
    </div>

    <div>
      <label style="display:block;color:var(--muted);font-size:13px;margin-bottom:6px">Options</label>
      <div style="display:flex;gap:8px">
        <button class="btn" id="btnPvC">Play vs CPU</button>
        <button class="btn" id="btnSym">Symmetric mode</button>
      </div>
    </div>

    <footer>Reset preserves scores. Use Undo to revert one move.</footer>
  </aside>
</div>

<script>
  // --- State ---
  const state = {
    board: Array(9).fill(null), // 'X' | 'O' | null
    turn: 'X',
    over: false,
    moveStack: [],
    scores: { X:0, O:0, D:0 },
    vsCpu: false,
    symmetric: false
  };

  const WIN_LINES = [
    [0,1,2],[3,4,5],[6,7,8],
    [0,3,6],[1,4,7],[2,5,8],
    [0,4,8],[2,4,6]
  ];

  // --- DOM refs ---
  const boardEl = document.getElementById('board');
  const turnEl = document.getElementById('turnPlayer');
  const resultEl = document.getElementById('result');
  const scoreX = document.getElementById('scoreX');
  const scoreO = document.getElementById('scoreO');
  const scoreD = document.getElementById('scoreD');
  const btnReset = document.getElementById('btnReset');
  const btnUndo = document.getElementById('btnUndo');
  const btnPvC = document.getElementById('btnPvC');
  const btnSym = document.getElementById('btnSym');

  // --- Init UI ---
  function createBoard(){
    boardEl.innerHTML = '';
    for(let i=0;i<9;i++){
      const cell = document.createElement('button');
      cell.className = 'cell';
      cell.dataset.idx = i;
      cell.addEventListener('click', onCellClick);
      boardEl.appendChild(cell);
    }
    render();
  }

  function render(){
    const cells = boardEl.children;
    state.board.forEach((v,i)=>{
      const el = cells[i];
      el.textContent = v || '';
      el.classList.toggle('disabled', !!v || state.over);
    });
    turnEl.textContent = state.turn;
    scoreX.textContent = state.scores.X;
    scoreO.textContent = state.scores.O;
    scoreD.textContent = state.scores.D;
  }

  // --- Game logic ---
  function onCellClick(e){
    const idx = Number(e.currentTarget.dataset.idx);
    if(state.over || state.board[idx]) return;
    makeMove(idx, state.turn);
    if(state.vsCpu && !state.over) setTimeout(cpuMove, 150);
  }

  function makeMove(idx, player){
    state.board[idx] = player;
    state.moveStack.push({idx,player});
    checkEnd();
    if(!state.over) state.turn = (player === 'X') ? 'O':'X';
    render();
  }

  function undo(){
    if(!state.moveStack.length || state.over) return;
    const last = state.moveStack.pop();
    state.board[last.idx] = null;
    state.turn = last.player;
    state.over = false;
    resultEl.style.display='none';
    render();
  }

  function checkEnd(){
    const winner = getWinner();
    if(winner){
      state.over = true;
      state.scores[winner]++;
      showResult(`${winner} wins!`, 'win');
      render();
      return winner;
    }
    if(state.board.every(Boolean)){
      state.over = true;
      state.scores.D++;
      showResult('Draw', 'draw');
      render();
      return 'D';
    }
    return null;
  }

  function getWinner(){
    for(const [a,b,c] of WIN_LINES){
      if(state.board[a] && state.board[a]===state.board[b] && state.board[b]===state.board[c]) return state.board[a];
    }
    return null;
  }

  function showResult(text, type){
    resultEl.style.display='block';
    resultEl.className = 'toast ' + (type==='win'?'win':'draw');
    resultEl.textContent = text;
  }

  // --- CPU (very simple) ---
  function cpuMove(){
    if(state.over) return;
    // simple: pick winning move, block opponent, else random
    const me = 'O', opp='X';
    // try win
    for(let i=0;i<9;i++) if(!state.board[i]){
      state.board[i]=me; if(getWinner()===me){ state.moveStack.push({idx:i,player:me}); state.over=true; state.scores[me]++; showResult('O wins!','win'); render(); return } state.board[i]=null;
    }
    // try block
    for(let i=0;i<9;i++) if(!state.board[i]){
      state.board[i]=opp; if(getWinner()===opp){ state.board[i]=me; state.moveStack.push({idx:i,player:me}); if(checkEnd()) return; state.turn='X'; render(); return } state.board[i]=null;
    }
    // center then corners then sides
    const order=[4,0,2,6,8,1,3,5,7];
    for(const i of order) if(!state.board[i]){ makeMove(i,me); return }
  }

  // --- Controls ---
  btnReset.addEventListener('click', ()=>{
    state.board.fill(null); state.turn='X'; state.over=false; state.moveStack=[]; resultEl.style.display='none'; render();
  });
  btnUndo.addEventListener('click', undo);
  btnPvC.addEventListener('click', ()=>{ state.vsCpu = !state.vsCpu; btnPvC.textContent = state.vsCpu ? 'Playing vs CPU' : 'Play vs CPU'; });
  btnSym.addEventListener('click', ()=>{ state.symmetric = !state.symmetric; btnSym.textContent = state.symmetric ? 'Symmetric on' : 'Symmetric mode'; });

  // --- Start ---
  createBoard();
</script>
</body>
</html>
